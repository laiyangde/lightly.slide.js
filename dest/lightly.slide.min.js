!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i():"function"==typeof define&&define.amd?define(i):i()}(this,function(){"use strict";var t=function t(i,s){return new t.fn.init(i,s)};t.fn=t.prototype,t.fn.version="1.0",t.fn.init=function(t,i){var s={direction:"horizontal",initialSlide:0,speed:300,autoplay:!1,spaceBetween:0,slidesPerView:1,slidesPerGroup:1,touchRatio:1,touchAngle:45,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,nextButton:null,prevButton:null,resistance:!0,resistanceRatio:.85,loop:!1,containerModifierClass:"lightly-container-",slideClass:"lightly-slide",slideActiveClass:"lightly-slide-active",wrapperClass:"lightly-wrapper",pagination:null,paginationClass:"lightly-pagination-container",paginationItemClass:"lightly-pagination-item",paginationItemActiveClass:"lightly-pagination-item-active",paginationClickable:!1,buttonDisabledClass:"lightly-button-disabled",constomPaginationItem:!1,runCallbacksOnInit:!1,autoplayDisableOnInteraction:!1};for(var e in i)s[e]=i[e];this.params=s;var t=document.querySelector(t);if(null===t)throw new Error("can not found container");this.addClass(t,this.params.containerModifierClass+this.params.direction);var a=t.querySelector("."+this.params.wrapperClass);if(null===a)throw new Error("can not found wrapper");if(this.params.pagination){var n=document.querySelector(this.params.pagination);this.addClass(n,this.params.paginationClass)}this.params.nextButton&&(this.nextButton=document.querySelector(this.params.nextButton)),this.params.prevButton&&(this.prevButton=document.querySelector(this.params.prevButton)),this.isHorizontal="horizontal"===this.params.direction,this.translate=0,this.params.loop&&this.createLoop(a),this.initContainerSize(t),this.initSlidesSize(a),this.initPagination(n),this.wrapper=a,this.container=t;var h=this.params.loop?this.params.initialSlide+this.params.slidesPerView:this.params.initialSlide;this.slideTo(h,0,this.params.runCallbacksOnInit),this.initEvents(),this.autoplayTimeoutId=void 0,this.autoplaying=!1,this.autoplayPaused=!1,this.params.autoplay&&this.startAutoplay(),this.emit("onInit",this)},t.fn.createLoop=function(t){for(var i,s=t.querySelectorAll("."+this.params.slideClass),e=this.params.slidesPerView,a=[],n=[],h=[],o=s.length,i=0;i<o;i++)i<e&&n.push(s[i]),i<o&&i>=o-e&&a.push(s[i]),s[i].setAttribute("data-index",i),h.push(i);for(i=0;i<n.length;i++)t.appendChild(n[i].cloneNode(!0)),h.push(i);for(i=a.length-1;i>=0;i--)t.insertBefore(a[i].cloneNode(!0),t.childNodes[0]),h.unshift(o-a.length+i);this.slideMap=h},t.fn.initContainerSize=function(t){var i,s,i=this.params.width||t.clientWidth,s=this.params.height||t.clientHeight;this.width=i,this.height=s,this.size=this.isHorizontal?this.width:this.height},t.fn.initSlidesSize=function(t){var i=t.querySelectorAll("."+this.params.slideClass);this.slideLen=i.length,this.snapGrid=[],this.slidesGrid=[];var s,e=this.params.spaceBetween,a=0,n=0;"string"==typeof e&&e.indexOf("%")>=0&&(e=parseFloat(e.replace("%",""))/100*this.size);var h=-e,o=(this.size-(this.params.slidesPerView-1)*e)/this.params.slidesPerView;for(s=0;s<this.slideLen;s++)this.isHorizontal?i[s].style.width=o+"px":i[s].style.height=o+"px",n%this.params.slidesPerGroup===0&&this.snapGrid.push(a),this.slidesGrid.push(a),a=a+o+e,h+=o+e,n++;this.slideSize=o,h=Math.max(h,this.size),this.snapGridLastIndex=this.snapGrid.length-1;var r=h-this.size;for(s=this.snapGridLastIndex;s>=0&&this.snapGrid[s]-r>1e-5;s--)this.snapGrid.pop(),this.snapGridLastIndex-=1;Math.floor(h-this.size)-Math.floor(this.snapGrid[this.snapGridLastIndex])>1&&(this.snapGrid.push(h-this.size),this.snapGridLastIndex+=1),0===this.snapGrid.length&&(this.snapGrid=[0]),this.snapGridLastValue=this.snapGrid[this.snapGridLastIndex],0!==this.params.spaceBetween&&(this.isHorizontal?this.styles(i,"marginRight",e+"px"):this.styles(i,"marginBottom",e+"px"))},t.fn.initPagination=function(t){if(t){for(var i="",s=this.params.loop?Math.ceil((this.slideLen-2*this.params.slidesPerView)/this.params.slidesPerGroup):this.snapGrid.length,e=0;e<s;e++)i+='<span class="'+this.params.paginationItemClass+'"></span>';t.innerHTML=i,this.paginationItems=t.querySelectorAll("."+this.params.paginationItemClass)}},t.fn.startAutoplay=function(){return"undefined"==typeof this.autoplayTimeoutId&&(!!this.params.autoplay&&(!this.autoplaying&&(this.autoplaying=!0,this.emit("onAutoplayStart",this),void this.autoplay())))},t.fn.stopAutoplay=function(t){this.autoplayTimeoutId&&(this.autoplayTimeoutId&&clearTimeout(this.autoplayTimeoutId),this.autoplaying=!1,this.autoplayTimeoutId=void 0,this.emit("onAutoplayStop",this))},t.fn.pauseAutoplay=function(t){var i=this;this.autoplayPaused||(this.autoplayTimeoutId&&clearTimeout(this.autoplayTimeoutId),this.autoplayPaused=!0,0===t?(this.autoplayPaused=!1,this.autoplay()):this.transitionEnd(function(){i.autoplayPaused=!1,i.autoplaying?i.autoplay():i.stopAutoplay()}))},t.fn.autoplay=function(t){var i=this.params.autoplay,s=this;this.autoplayTimeoutId=setTimeout(function(){s.params.loop?(s.slideNext(!0,t,!0),s.emit("onAutoplay",s)):s.isEnd?s.params.autoplayStopOnLast?s.stopAutoplay():(s.slideTo(0,t,!0,!0),s.emit("onAutoplay",s)):(s.slideNext(!0,t,!0),s.emit("onAutoplay",s))},i)},t.fn.updatePagination=function(){if(this.paginationItems&&!(this.paginationItems<=0)){var t,i=this.params.loop?Math.ceil((this.slideLen-2*this.params.slidesPerView)/this.params.slidesPerGroup):this.snapGrid.length;this.params.loop?(t=Math.ceil((this.activeIndex-this.params.slidesPerView)/this.params.slidesPerGroup),t>this.slideLen-1-2*this.params.slidesPerView&&(t-=this.slideLen-2*this.params.slidesPerView),t>i-1&&(t-=i)):t="undefined"!=typeof this.snapIndex?this.snapIndex:this.activeIndex||0,this.paginationItems[this.prevCurrent||0].classList.remove(this.params.paginationItemActiveClass),this.paginationItems[t].classList.add(this.params.paginationItemActiveClass),this.prevCurrent=t,this.slideIndex=t}},t.fn.updateButton=function(){!this.params.loop&&this.params.nextButton&&(this.isBeginning?this.prevButton.classList.add(this.params.buttonDisabledClass):this.prevButton.classList.remove(this.params.buttonDisabledClass),this.isEnd?this.nextButton.classList.add(this.params.buttonDisabledClass):this.nextButton.classList.remove(this.params.buttonDisabledClass))},t.fn.slideTo=function(t,i,s,e){"undefined"==typeof s&&(s=!0),"undefined"==typeof t&&(t=0),t<0&&(t=0),this.snapIndex=Math.floor(t/this.params.slidesPerGroup),this.snapIndex>=this.snapGrid.length&&(this.snapIndex=this.snapGridLastIndex);var a=-this.snapGrid[this.snapIndex];if(this.params.autoplay&&this.autoplaying&&(e||!this.params.autoplayDisableOnInteraction?this.pauseAutoplay(i):this.stopAutoplay()),this.updateBothsEnd(a),"undefined"==typeof i&&(i=this.params.speed),this.previousIndex=this.activeIndex||0,this.activeIndex=t,this.realIndex=this.params.loop?this.slideMap[t]:t,this.updatePagination(),this.updateButton(),a===this.translate)return!1;if(this.onTransitionStart(s),0===i)this.setWrapperTranslate(a),this.setWrapperTransition(0),this.onTransitionEnd(s);else if(this.setWrapperTranslate(a),this.setWrapperTransition(i),!this.animating){var n=this;this.animating=!0,this.transitionEnd(this.wrapper,function(){n.onTransitionEnd(s)})}return!0},t.fn.onTransitionStart=function(t){"undefined"==typeof t&&(t=!0),t&&(this.emit("onTransitionStart",this),this.activeIndex!==this.previousIndex&&(this.emit("onSlideChangeStart",this),this.activeIndex>this.previousIndex?this.emit("onSlideNextStart",this):this.emit("onSlidePrevStart",this)))},t.fn.onTransitionEnd=function(t){this.animating=!1,this.setWrapperTransition(0),"undefined"==typeof t&&(t=!0),t&&(this.emit("onTransitionEnd",this),this.activeIndex!==this.previousIndex&&(this.emit("onSlideChangeEnd",this),this.activeIndex>this.previousIndex?this.emit("onSlideNextEnd",this):this.emit("onSlidePrevEnd",this)))},t.fn.setWrapperTransition=function(t){this.wrapper.style.webkitTransitionDuration=this.wrapper.style.transitionDuration=t+"ms"},t.fn.setWrapperTranslate=function(t,i,s){var e=0,a=0;this.isHorizontal?e=t:a=t,this.wrapper.style.webkitTransform=this.wrapper.style.transform="translate3d("+e+"px, "+a+"px, 0px)",this.translate=this.isHorizontal?e:a},t.fn.updateBothsEnd=function(t){"undefined"==typeof t&&(t=this.translate||0),this.isBeginning=-t<=0,this.isEnd=-t>=this.snapGrid[this.snapGridLastIndex]},t.fn.emit=function(t){this.params[t]&&this.params[t].apply(this,arguments)},t.fn.initEvents=function(){this.touches={startX:0,startY:0,currentX:0,currentY:0,diff:0},this.count=0,this.onTouchMoveHandle=this.onTouchMove.bind(this),this.onTouchEndHandle=this.onTouchEnd.bind(this),this.container.addEventListener("touchstart",this.onTouchStart.bind(this),!1),this.params.nextButton&&this.nextButton&&this.nextButton.addEventListener("click",this.onClickNext.bind(this),!1),this.params.prevButton&&this.prevButton&&this.prevButton.addEventListener("click",this.onClickPrev.bind(this),!1)},t.fn.onClickNext=function(t){t.preventDefault(),this.isEnd&&!this.params.loop||this.slideNext()},t.fn.onClickPrev=function(t){t.preventDefault(),this.isBeginning&&!this.params.loop||this.slidePrev()},t.fn.onTouchStart=function(t){var i=this.touches.currentX=t.targetTouches[0].pageX,s=this.touches.currentY=t.targetTouches[0].pageY,e=this.container;this.touches.isTouched=!0,this.touches.isMoved=!1,this.touches.allowTouchCallbacks=!0,this.touches.isScrolling=void 0,this.touches.startMoving=void 0,this.touches.startX=i,this.touches.startY=s,this.touches.touchStartTime=Date.now(),this.allowClick=!0,this.swipeDirection=void 0,this.emit("onTouchStart",this,t),e.addEventListener("touchmove",this.onTouchMoveHandle,!1),e.addEventListener("touchend",this.onTouchEndHandle,!1)},t.fn.onTouchMove=function(t){if(t.targetTouches&&t.targetTouches.length>1)return void this.removeTouch();if(this.touches.currentX=t.targetTouches[0].pageX,this.touches.currentY=t.targetTouches[0].pageY,"undefined"==typeof this.touches.isScrolling){var i;this.isHorizontal&&this.touches.currentY===this.touches.startY||!this.isHorizontal&&this.touches.currentX===this.touches.startX?this.touches.isScrolling=!1:(i=180*Math.atan2(Math.abs(this.touches.currentY-this.touches.startY),Math.abs(this.touches.currentX-this.touches.startX))/Math.PI,this.touches.isScrolling=this.isHorizontal?i>this.params.touchAngle:90-i>this.params.touchAngle)}if(this.touches.isTouched){if(this.touches.isScrolling)return void(this.touches.isTouched=!1);if(this.allowClick=!1,t.preventDefault(),t.stopPropagation(),!this.touches.isMoved){if(this.params.loop&&this.fixLoop(),this.touches.startTranslate=this.translate,this.setWrapperTransition(0),this.animating){var s=null===window.ontransitionend?"transitionend":"webkitTransitionEnd";this.trigger(this.wrapper,s)}this.params.autoplay&&this.autoplaying&&(this.params.autoplayDisableOnInteraction?this.stopAutoplay():this.pauseAutoplay()),this.touches.allowMomentumBounce=!1}this.touches.isMoved=!0;var e=this.touches.diff=this.isHorizontal?this.touches.currentX-this.touches.startX:this.touches.currentY-this.touches.startY;e*=this.params.touchRatio,this.swipeDirection=e>0?"prev":"next",this.currentTranslate=e+this.touches.startTranslate,e>0&&this.currentTranslate>0?this.params.resistance&&(this.currentTranslate=-1+Math.pow(this.currentTranslate,this.params.resistanceRatio)):e<0&&this.currentTranslate<-this.snapGridLastValue&&this.params.resistance&&(this.currentTranslate=-this.snapGridLastValue+1-Math.pow(-this.snapGridLastValue-this.currentTranslate,this.params.resistanceRatio)),this.params.followFinger&&this.setWrapperTranslate(this.currentTranslate)}},t.fn.onTouchEnd=function(t){if(this.touches.allowTouchCallbacks&&this.emit("onTouchEnd",this,t),this.touches.allowTouchCallbacks=!1,this.touches.isTouched){var i=Date.now(),e=i-this.touches.touchStartTime;if(!this.touches.isTouched||!this.touches.isMoved||!this.swipeDirection||0===this.touches.diff||this.touches.currentTranslate===this.touches.startTranslate)return void(this.touches.isTouched=this.touches.isMoved=!1);this.touches.isTouched=this.touches.isMoved=!1;var a,n=this.params.followFinger?-this.translate:-this.touches.currentTranslate,h=0,o=this.slideSize;for(a=0;a<this.slidesGrid.length;a+=this.params.slidesPerGroup)"undefined"!=typeof this.slidesGrid[a+this.params.slidesPerGroup]?n>=this.slidesGrid[a]&&n<this.slidesGrid[a+this.params.slidesPerGroup]&&(h=a,o=this.slidesGrid[a+this.params.slidesPerGroup]-this.slidesGrid[a]):n>=this.slidesGrid[a]&&(h=a,o=this.slidesGrid[this.slideLen]-this.slidesGrid[this.slideLen-1]);var r=(n-this.slidesGrid[h])/o;if(e>this.params.longSwipesMs){if(!this.params.longSwipes)return void this.slideTo(this.activeIndex);"next"===this.swipeDirection&&(r>=this.params.longSwipesRatio?this.slideTo(h+this.params.slidesPerGroup):this.slideTo(h)),"prev"===this.swipeDirection&&(r>1-this.params.longSwipesRatio?this.slideTo(h+this.params.slidesPerGroup):this.slideTo(h))}else{if(!this.params.shortSwipes)return void this.slideTo(s.activeIndex);"next"===this.swipeDirection&&this.slideTo(h+this.params.slidesPerGroup),"prev"===this.swipeDirection&&this.slideTo(h)}this.removeTouch()}},t.fn.removeTouch=function(){var t=this.container;t.removeEventListener("touchmove",this.onTouchMoveHandle),t.removeEventListener("touchend",this.onTouchEndHandle)},t.fn.slideNext=function(t,i,s){return this.params.loop?!this.animating&&(this.fixLoop(),this.container.clientLeft,this.slideTo(this.activeIndex+this.params.slidesPerGroup,i,t,s)):this.slideTo(this.activeIndex+this.params.slidesPerGroup,i,t,s)},t.fn.slidePrev=function(t,i,s){return this.params.loop?!this.animating&&(this.fixLoop(),this.container.clientLeft,this.slideTo(this.activeIndex-this.params.slidesPerGroup,i,t,s)):this.slideTo(this.activeIndex-this.params.slidesPerGroup,i,t,s)},t.fn.fixLoop=function(){var t;this.activeIndex<this.params.slidesPerView?(t=this.slideLen-3*this.params.slidesPerView+this.activeIndex,t+=this.params.slidesPerView,this.slideTo(t,0,!1,!0)):this.activeIndex>this.slideLen-2*this.params.slidesPerView&&(t=-this.slideLen+this.activeIndex+this.params.slidesPerView,t+=this.params.slidesPerView,this.slideTo(t,0,!1,!0))},t.fn.addClass=function(t,i){for(var i=i.split(" "),s=0;s<i.length;s++)t.classList.add(i[s])},t.fn.styles=function(t,i,s){for(var e=t.length,a=0;a<e;a++)this.style(t[a],i,s)},t.fn.style=function(t,i,s){if(3===arguments.length)t.style[i]=s;else for(var e in i)t.style[e]=i[e]},t.fn.transitionEnd=function(t,i){function s(a){i.call(this,a),t.removeEventListener(e,s)}var e=null===window.ontransitionend?"transitionend":"webkitTransitionEnd";i&&t.addEventListener(e,s,!1)},t.fn.trigger=function(t,i,s){var e;try{e=new window.CustomEvent(i,{detail:s,bubbles:!0,cancelable:!0})}catch(t){e=document.createEvent("Event"),e.initEvent(i,!0,!0),e.detail=s}t.dispatchEvent(e)},t.fn.init.prototype=t.fn,window.lightlySlide=t});
